{"AWSTemplateFormatVersion":"2010-09-09","Description":"Media Services Workflow created by MediaLive","Resources":{"MediaLiveInput":{"Type":"AWS::MediaLive::Input","Properties":{"Name":"live-video-training-Input","Type":"MP4_FILE","Tags":{"MSAM-Diagram":"live-video-training","MSAM-Tile":"live-video-training","MediaLive-Workflow":"live-video-training"},"Sources":[{"Url":"https://aws-tc-largeobjects.s3.us-west-2.amazonaws.com/SPL-TF-100-MSWWIZ-1/source/vanlife.mp4"}]},"DependsOn":[]},"MediaPackageChannel":{"Type":"AWS::MediaPackage::Channel","Properties":{"Description":"Channel created by MediaLive workflow - live-video-training","Id":"live-video-training","Tags":[{"Key":"MSAM-Diagram","Value":"live-video-training"},{"Key":"MSAM-Tile","Value":"live-video-training"},{"Key":"MediaLive-Workflow","Value":"live-video-training"}]}},"MediaPackageHLSEndpoint":{"Type":"AWS::MediaPackage::OriginEndpoint","Properties":{"Id":"live-video-trainingHLSEndpoint","ChannelId":"live-video-training","Description":"HLS endpoint created by MediaLive for channel live-video-training","ManifestName":"index","StartoverWindowSeconds":0,"TimeDelaySeconds":0,"HlsPackage":{"AdMarkers":"NONE","AdsOnDeliveryRestrictions":"RESTRICTED","AdTriggers":["SPLICE_INSERT","PROVIDER_ADVERTISEMENT","DISTRIBUTOR_ADVERTISEMENT","PROVIDER_PLACEMENT_OPPORTUNITY","DISTRIBUTOR_PLACEMENT_OPPORTUNITY"],"IncludeIframeOnlyStream":false,"PlaylistType":"EVENT","PlaylistWindowSeconds":60,"ProgramDateTimeIntervalSeconds":0,"SegmentDurationSeconds":6,"StreamSelection":{"StreamOrder":"ORIGINAL"},"UseAudioRenditionGroup":false},"Origination":"ALLOW","Tags":[{"Key":"MSAM-Diagram","Value":"live-video-training"},{"Key":"MSAM-Tile","Value":"live-video-training"},{"Key":"MediaLive-Workflow","Value":"live-video-training"}]},"DependsOn":"MediaPackageChannel"},"MediaPackageCMAFEndpoint":{"Type":"AWS::MediaPackage::OriginEndpoint","Properties":{"Id":"live-video-trainingCMAFEndpoint","ChannelId":"live-video-training","Description":"CMAF endpoint created by MediaLive for channel live-video-training","ManifestName":"index","StartoverWindowSeconds":0,"TimeDelaySeconds":0,"CmafPackage":{"SegmentDurationSeconds":2,"SegmentPrefix":"2","HlsManifests":[{"Id":"CMAF_HLS","PlaylistWindowSeconds":60,"PlaylistType":"EVENT","AdMarkers":"NONE","AdTriggers":["SPLICE_INSERT","PROVIDER_ADVERTISEMENT","DISTRIBUTOR_ADVERTISEMENT","PROVIDER_PLACEMENT_OPPORTUNITY","DISTRIBUTOR_PLACEMENT_OPPORTUNITY"],"AdsOnDeliveryRestrictions":"RESTRICTED","IncludeIframeOnlyStream":false}],"StreamSelection":{"StreamOrder":"ORIGINAL"}},"Origination":"ALLOW","Tags":[{"Key":"MSAM-Diagram","Value":"live-video-training"},{"Key":"MSAM-Tile","Value":"live-video-training"},{"Key":"MediaLive-Workflow","Value":"live-video-training"}]},"DependsOn":"MediaPackageChannel"},"MediaPackageDASHEndpoint":{"Type":"AWS::MediaPackage::OriginEndpoint","Properties":{"Id":"live-video-trainingDASHEndpoint","ChannelId":"live-video-training","Description":"DASH endpoint created by MediaLive for channel live-video-training","ManifestName":"index","StartoverWindowSeconds":0,"TimeDelaySeconds":0,"DashPackage":{"SegmentDurationSeconds":2,"ManifestWindowSeconds":60,"Profile":"NONE","MinUpdatePeriodSeconds":15,"MinBufferTimeSeconds":30,"SuggestedPresentationDelaySeconds":25,"PeriodTriggers":[],"ManifestLayout":"FULL","SegmentTemplateFormat":"NUMBER_WITH_TIMELINE","AdTriggers":["SPLICE_INSERT","PROVIDER_ADVERTISEMENT","DISTRIBUTOR_ADVERTISEMENT","PROVIDER_PLACEMENT_OPPORTUNITY","DISTRIBUTOR_PLACEMENT_OPPORTUNITY"],"AdsOnDeliveryRestrictions":"RESTRICTED","StreamSelection":{"StreamOrder":"ORIGINAL"}},"Origination":"ALLOW","Tags":[{"Key":"MSAM-Diagram","Value":"live-video-training"},{"Key":"MSAM-Tile","Value":"live-video-training"},{"Key":"MediaLive-Workflow","Value":"live-video-training"}]},"DependsOn":"MediaPackageChannel"},"MediaPackageCloudFrontDistribution":{"Type":"AWS::CloudFront::Distribution","Properties":{"DistributionConfig":{"Enabled":true,"Comment":"Created by MediaLive workflow live-video-training","CustomErrorResponses":[{"ErrorCode":400,"ErrorCachingMinTTL":1},{"ErrorCode":403,"ErrorCachingMinTTL":1},{"ErrorCode":404,"ErrorCachingMinTTL":1},{"ErrorCode":405,"ErrorCachingMinTTL":1},{"ErrorCode":414,"ErrorCachingMinTTL":1},{"ErrorCode":416,"ErrorCachingMinTTL":1},{"ErrorCode":500,"ErrorCachingMinTTL":1},{"ErrorCode":501,"ErrorCachingMinTTL":1},{"ErrorCode":502,"ErrorCachingMinTTL":1},{"ErrorCode":503,"ErrorCachingMinTTL":1},{"ErrorCode":504,"ErrorCachingMinTTL":1}],"DefaultCacheBehavior":{"TargetOriginId":"EMP-live-video-training","AllowedMethods":["GET","HEAD"],"CachedMethods":["GET","HEAD"],"Compress":false,"ForwardedValues":{"QueryString":true,"QueryStringCacheKeys":["m","start","end"]},"SmoothStreaming":false,"ViewerProtocolPolicy":"redirect-to-https","MinTTL":0,"DefaultTTL":86400,"MaxTTL":31536000},"Origins":[{"Id":"EMP-live-video-training","DomainName":{"Fn::Select":[0,{"Fn::Split":["/",{"Fn::Select":[1,{"Fn::Split":["https://",{"Fn::GetAtt":["MediaPackageHLSEndpoint","Url"]}]}]}]}]},"OriginPath":"","CustomOriginConfig":{"HTTPPort":80,"HTTPSPort":443,"OriginProtocolPolicy":"match-viewer","OriginSSLProtocols":["TLSv1","TLSv1.1","TLSv1.2"],"OriginReadTimeout":30,"OriginKeepaliveTimeout":5}}],"PriceClass":"PriceClass_All"},"Tags":[{"Key":"mediapackage:cloudfront_assoc","Value":{"Fn::GetAtt":["MediaPackageChannel","Arn"]}},{"Key":"MSAM-Diagram","Value":"live-video-training"},{"Key":"MSAM-Tile","Value":"live-video-training"},{"Key":"MediaLive-Workflow","Value":"live-video-training"}]},"DependsOn":["MediaPackageHLSEndpoint","MediaPackageCMAFEndpoint","MediaPackageDASHEndpoint"]},"MediaLiveChannel":{"Type":"AWS::MediaLive::Channel","Properties":{"Name":"live-video-training","ChannelClass":"SINGLE_PIPELINE","LogLevel":"DISABLED","RoleArn":"arn:aws:iam::690154025901:role/MediaLiveAccessRole","InputAttachments":[{"InputAttachmentName":"live-video-training","InputId":{"Ref":"MediaLiveInput"},"InputSettings":{"AudioSelectors":[],"CaptionSelectors":[],"DeblockFilter":"DISABLED","DenoiseFilter":"DISABLED","FilterStrength":1,"InputFilter":"AUTO","Smpte2038DataPreference":"IGNORE","SourceEndBehavior":"LOOP"}}],"InputSpecification":{"Codec":"AVC","MaximumBitrate":"MAX_20_MBPS","Resolution":"HD"},"Destinations":[{"Id":"mediapackage-destination","MediaPackageSettings":[{"ChannelId":"live-video-training"}]}],"EncoderSettings":{"AudioDescriptions":[{"Name":"audio_mediapackage_0","AudioSelectorName":"Default","AudioTypeControl":"FOLLOW_INPUT","LanguageCodeControl":"FOLLOW_INPUT","CodecSettings":{"AacSettings":{"InputType":"NORMAL","Bitrate":128000,"CodingMode":"CODING_MODE_2_0","RawFormat":"NONE","Spec":"MPEG4","Profile":"LC","RateControlMode":"CBR","SampleRate":48000}}},{"Name":"audio_mediapackage_1","AudioSelectorName":"Default","AudioTypeControl":"FOLLOW_INPUT","LanguageCodeControl":"FOLLOW_INPUT","CodecSettings":{"AacSettings":{"InputType":"NORMAL","Bitrate":128000,"CodingMode":"CODING_MODE_2_0","RawFormat":"NONE","Spec":"MPEG4","Profile":"LC","RateControlMode":"CBR","SampleRate":48000}}},{"Name":"audio_mediapackage_2","AudioSelectorName":"Default","AudioTypeControl":"FOLLOW_INPUT","LanguageCodeControl":"FOLLOW_INPUT","CodecSettings":{"AacSettings":{"InputType":"NORMAL","Bitrate":128000,"CodingMode":"CODING_MODE_2_0","RawFormat":"NONE","Spec":"MPEG4","Profile":"LC","RateControlMode":"CBR","SampleRate":48000}}},{"Name":"audio_mediapackage_3","AudioSelectorName":"Default","AudioTypeControl":"FOLLOW_INPUT","LanguageCodeControl":"FOLLOW_INPUT","CodecSettings":{"AacSettings":{"InputType":"NORMAL","Bitrate":128000,"CodingMode":"CODING_MODE_2_0","RawFormat":"NONE","Spec":"MPEG4","Profile":"LC","RateControlMode":"CBR","SampleRate":48000}}}],"CaptionDescriptions":[],"OutputGroups":[{"Name":"mediapackage","OutputGroupSettings":{"MediaPackageGroupSettings":{"Destination":{"DestinationRefId":"mediapackage-destination"}}},"Outputs":[{"OutputName":"emp_1080p30","VideoDescriptionName":"emp_1080p30","AudioDescriptionNames":["audio_mediapackage_0"],"CaptionDescriptionNames":[],"OutputSettings":{"MediaPackageOutputSettings":{}}},{"OutputName":"emp_720p30","VideoDescriptionName":"emp_720p30","AudioDescriptionNames":["audio_mediapackage_1"],"CaptionDescriptionNames":[],"OutputSettings":{"MediaPackageOutputSettings":{}}},{"OutputName":"emp_480p30","VideoDescriptionName":"emp_480p30","AudioDescriptionNames":["audio_mediapackage_2"],"CaptionDescriptionNames":[],"OutputSettings":{"MediaPackageOutputSettings":{}}},{"OutputName":"emp_240p30","VideoDescriptionName":"emp_240p30","AudioDescriptionNames":["audio_mediapackage_3"],"CaptionDescriptionNames":[],"OutputSettings":{"MediaPackageOutputSettings":{}}}]}],"TimecodeConfig":{"Source":"EMBEDDED"},"VideoDescriptions":[{"CodecSettings":{"H264Settings":{"AfdSignaling":"NONE","ColorMetadata":"INSERT","AdaptiveQuantization":"HIGH","EntropyEncoding":"CABAC","FlickerAq":"DISABLED","ForceFieldPictures":"DISABLED","FramerateControl":"SPECIFIED","FramerateNumerator":30000,"FramerateDenominator":1001,"GopBReference":"DISABLED","GopClosedCadence":1,"GopNumBFrames":3,"GopSize":60,"GopSizeUnits":"FRAMES","SubgopLength":"DYNAMIC","ScanType":"PROGRESSIVE","Level":"H264_LEVEL_AUTO","LookAheadRateControl":"HIGH","MaxBitrate":5000000,"NumRefFrames":3,"ParControl":"SPECIFIED","ParNumerator":1,"ParDenominator":1,"Profile":"HIGH","QvbrQualityLevel":9,"RateControlMode":"QVBR","Syntax":"DEFAULT","SceneChangeDetect":"ENABLED","Slices":1,"SpatialAq":"ENABLED","TemporalAq":"ENABLED","TimecodeInsertion":"DISABLED"}},"Height":1080,"Name":"emp_1080p30","RespondToAfd":"NONE","Sharpness":50,"ScalingBehavior":"DEFAULT","Width":1920},{"CodecSettings":{"H264Settings":{"AfdSignaling":"NONE","ColorMetadata":"INSERT","AdaptiveQuantization":"HIGH","EntropyEncoding":"CABAC","FlickerAq":"DISABLED","ForceFieldPictures":"DISABLED","FramerateControl":"SPECIFIED","FramerateNumerator":30000,"FramerateDenominator":1001,"GopBReference":"DISABLED","GopClosedCadence":1,"GopNumBFrames":3,"GopSize":60,"GopSizeUnits":"FRAMES","SubgopLength":"DYNAMIC","ScanType":"PROGRESSIVE","Level":"H264_LEVEL_AUTO","LookAheadRateControl":"HIGH","MaxBitrate":3000000,"NumRefFrames":3,"ParControl":"SPECIFIED","ParNumerator":1,"ParDenominator":1,"Profile":"HIGH","QvbrQualityLevel":8,"RateControlMode":"QVBR","Syntax":"DEFAULT","SceneChangeDetect":"ENABLED","Slices":1,"SpatialAq":"ENABLED","TemporalAq":"ENABLED","TimecodeInsertion":"DISABLED"}},"Height":720,"Name":"emp_720p30","RespondToAfd":"NONE","Sharpness":75,"ScalingBehavior":"DEFAULT","Width":1280},{"CodecSettings":{"H264Settings":{"AfdSignaling":"NONE","ColorMetadata":"INSERT","AdaptiveQuantization":"HIGH","EntropyEncoding":"CABAC","FlickerAq":"DISABLED","ForceFieldPictures":"DISABLED","FramerateControl":"SPECIFIED","FramerateNumerator":30000,"FramerateDenominator":1001,"GopBReference":"ENABLED","GopClosedCadence":1,"GopNumBFrames":3,"GopSize":60,"GopSizeUnits":"FRAMES","SubgopLength":"DYNAMIC","ScanType":"PROGRESSIVE","Level":"H264_LEVEL_AUTO","LookAheadRateControl":"HIGH","MaxBitrate":1500000,"NumRefFrames":3,"ParControl":"SPECIFIED","ParNumerator":1,"ParDenominator":1,"Profile":"MAIN","QvbrQualityLevel":8,"RateControlMode":"QVBR","Syntax":"DEFAULT","SceneChangeDetect":"ENABLED","Slices":1,"SpatialAq":"ENABLED","TemporalAq":"ENABLED","TimecodeInsertion":"DISABLED"}},"Height":480,"Name":"emp_480p30","RespondToAfd":"NONE","Sharpness":100,"ScalingBehavior":"STRETCH_TO_OUTPUT","Width":854},{"CodecSettings":{"H264Settings":{"AfdSignaling":"NONE","ColorMetadata":"INSERT","AdaptiveQuantization":"HIGH","EntropyEncoding":"CABAC","FlickerAq":"DISABLED","ForceFieldPictures":"DISABLED","FramerateControl":"SPECIFIED","FramerateNumerator":30000,"FramerateDenominator":1001,"GopBReference":"ENABLED","GopClosedCadence":1,"GopNumBFrames":3,"GopSize":60,"GopSizeUnits":"FRAMES","SubgopLength":"DYNAMIC","ScanType":"PROGRESSIVE","Level":"H264_LEVEL_AUTO","LookAheadRateControl":"HIGH","MaxBitrate":750000,"NumRefFrames":3,"ParControl":"SPECIFIED","ParNumerator":1,"ParDenominator":1,"Profile":"MAIN","QvbrQualityLevel":8,"RateControlMode":"QVBR","Syntax":"DEFAULT","SceneChangeDetect":"ENABLED","Slices":1,"SpatialAq":"ENABLED","TemporalAq":"ENABLED","TimecodeInsertion":"DISABLED"}},"Height":240,"Name":"emp_240p30","RespondToAfd":"NONE","Sharpness":100,"ScalingBehavior":"STRETCH_TO_OUTPUT","Width":426}]},"Tags":{"MSAM-Diagram":"live-video-training","MSAM-Tile":"live-video-training","MediaLive-Workflow":"live-video-training"}},"DependsOn":["MediaLiveInput","MediaPackageChannel","MediaPackageHLSEndpoint","MediaPackageCMAFEndpoint","MediaPackageDASHEndpoint"]}}}